<!DOCTYPE html>
<html >
  <head>
    <meta charset="UTF-8">
    <title>Socket IO Private Chat Messaging</title>
    <link rel='stylesheet prefetch' href='https://fonts.googleapis.com/css?family=Open+Sans'>
	<link rel='stylesheet prefetch' href='https://cdnjs.cloudflare.com/ajax/libs/malihu-custom-scrollbar-plugin/3.1.3/jquery.mCustomScrollbar.min.css'>
	<link href="https://wmuza.github.io/SocketIO-Chat-App/public/css/normalize.css" rel="stylesheet" type="text/css">
    <link href="https://wmuza.github.io/SocketIO-Chat-App/public/css/style.css" rel="stylesheet" type="text/css">
  </head>

  <body>

		<style>

		</style>
		
		<div class="container ctn-chatssistant">
			<div id="bubbles" class="d-flex align-items-end justify-content-end">
				<div id='call' class="thought hidden shadow"> Miaou internaute ! Par ici ! </div>
				<div id='wait' class="thought hidden shadow bubbles"> D'accord ! Je suis l√† au besoin </div>
				<div id="form-chatssistant" class="thought hidden shadow slider-ctn bubbles">
					<div class="slider-inner">
						<div class="chat">
						<div class="messages">
							<div class="messages-content"></div>
						</div>
						<div class="message-box">
							<textarea type="text" class="message-input" placeholder="Type message..."></textarea>
							<button type="submit" class="message-submit">Send</button>
						</div>

		
					</div>
					</div>
					
				</div>
			</div>
			<button id="chatssistant" onclick="formReset()" class="shadow-sm btn btn-light rounded-circle bounce2"></button>
		
		</div>
		
	<script>
	
		function handleToggle(arr) {
			arr.forEach(e => document.querySelector(e).classList.toggle('active'))
			}
			
		function bubbleCheck(selector) {
	
				let check = false;
	
				document.querySelectorAll(selector).forEach(e => {
					if (e.classList.contains('active')) {
						check = true;
					}
				})
				return check;
			}
	
		function formReset() {
	
			document.querySelectorAll('.slider-img').forEach((e, index) => index !== 0 ? e.classList.remove('active') : 			e.classList.add('active'))
	
			bubbleCheck('#call') && handleToggle(['#call'])
	
			if(!bubbleCheck('#form-chatssistant') ) {
				handleToggle(['#form-chatssistant'])
			} else {
				handleToggle(['#form-chatssistant', '#wait'])
				setTimeout(() => {handleToggle(['#wait'])}, 3000)
			}
	
		}
		
		function checkCheckBoxes(selector) {
			
			let checked = false;
			let elt = document.querySelectorAll(selector);
			
			elt.forEach(e => {
				if(e.checked) {
					checked = true
				}
			})
			return checked;
		}
		
		function promiseCheckBoxes(selector) {
			return new Promise ((res, rej) => {
				!checkCheckBoxes(selector) ? res(true) : rej(false)
			})
		}
			
		function promiseSelect(selector) {
			
			let elt = document.querySelector(selector)
			return new Promise ((resolve, reject) => {
			elt.value === '' ? resolve(true) : reject(false)
				
			})
			
		}
	
		function resolvePromise({
			call : call,
			promiseSelector : promiseSelector,
			feedBackSelector : feedBackSelector = promiseSelector,
			handleToggle : array
		}) {
			call(promiseSelector)
				.then((result) => {
					document.querySelector(feedBackSelector).classList.add('is-invalid')
				})
				.catch((error) => {
					handleToggle(array)
				})
		}
	
		window.addEventListener('load', () => {
	
			setInterval(() => {
				if(!bubbleCheck('.bubbles')) {
					$('#call').toggleClass('active');
					setTimeout(() => {
							$('#call').toggleClass('active'); 
					}, 3000)	
				}
			}, 10000);
	
		})
	</script>
		
		
    <script src='https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.3/jquery.min.js'></script>
	<script src='https://cdnjs.cloudflare.com/ajax/libs/malihu-custom-scrollbar-plugin/3.1.3/jquery.mCustomScrollbar.concat.min.js'></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/2.1.1/socket.io.js"></script>
	<script src="https://wmuza.github.io/SocketIO-Chat-App/public/js/index.js"></script>     
  </body>
</html>
